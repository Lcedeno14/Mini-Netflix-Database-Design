<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Netflix DB Interface</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #141414;
            color: #e5e5e5;
        }

        h1 {
            text-align: center;
            margin: 20px;
            color: #fff;
        }

        .tab-container {
            display: flex;
            justify-content: center;
            background-color: #000;
            padding: 10px 0;
        }

        .tab {
            padding: 15px 30px;
            margin: 0 10px;
            cursor: pointer;
            font-size: 16px;
            color: #fff;
            border: 1px solid #333;
            border-radius: 5px;
            background-color: #000;
            transition: background-color 0.3s;
        }

        .tab:hover, .tab.active {
            background-color: #e50914;
        }

        .container {
            padding: 20px;
        }

        .query-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        button {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            color: #fff;
            background-color: #141414;
            border: 1px solid #333;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #e50914;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 20px;
        }

        .input-group label {
            margin-bottom: 5px;
            font-size: 14px;
        }

        .input-group input {
            padding: 8px;
            border: 1px solid #333;
            border-radius: 5px;
            background-color: #333;
            color: #fff;
            font-size: 14px;
        }

        .output {
            margin-top: 30px;
            background-color: #333;
            padding: 20px;
            border-radius: 5px;
        }

        .output pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <h1>Netflix Database Interface</h1>

    <!-- Tab Container -->
    <div class="tab-container">
        <div id="query-one-tab" class="tab active" onclick="changeTab('query-one')">Query 1</div>
        <div id="query-two-tab" class="tab" onclick="changeTab('query-two')">Query 2</div>
        <div id="query-three-tab" class="tab" onclick="changeTab('query-three')">Query 3</div>
        <div id="aquery-four-tab" class="tab" onclick="changeTab('query-four')">Query 4</div>
    </div>

    <!-- Query 1 -->
    <div id="query-one" class="container tab-content">
        <h2>Find the number of profiles for the given user.</h2>
        <p>Using LEFT JOIN on profiles and user and confirming the email matches</p>
        <div class="query-container">
            <input type="email" id="userEmail" placeholder="Enter user email" style="text-align: center" required>
            <button onclick="queryOne()">Submit the query</button> 
            
        </div>
    </div>

    <!-- Query 2 -->
    <div id="query-two" class="container tab-content" style="display: none;">
        <h2>Find the users and the profiles who watched the given movie and stopped past 30 mins time.</h2>
        <p>Using JOIN on users, content, profiles, watch_history.</p>
        <p>Using GROUP BY to sort based on profile_id and user_id</p>
        <div class="query-container">
            <input type="text" id="movieName" placeholder="Enter the movie name" style="text-align: center" required>
            <button onclick="queryTwo()">Submit the query</button> 
        </div>
    </div>

    <!-- Query 3 -->


    <!-- Output Section -->
    <div class="output" id="output"></div>

    <script>
        // Function to switch tabs
        function changeTab(tabName) {
            document.getElementById("output").innerHTML = '';
            const tabContents = document.querySelectorAll('.tab-content');
            const tabs = document.querySelectorAll('.tab');

            // Hide all tab contents
            tabContents.forEach(content => content.style.display = 'none');

            // Remove the active class from all tabs
            tabs.forEach(tab => tab.classList.remove('active'));

            // Show the selected tab content
            document.getElementById(tabName).style.display = 'block';

            // Add the active class to the clicked tab
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }

        // Query 1
        async function queryOne() {
            const email = document.getElementById('userEmail').value;
            if (!email) {
                alert("Please enter an email.");
                return;
            }
            try {
                // Make the API request, passing the email as a path parameter
                const response = await fetch(`http://localhost:8001/query_one/${encodeURIComponent(email)}`);
                // Check if the response is OK
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                // Parse the JSON response
                const result = await response.json();
                document.getElementById('output').innerHTML = "email: " + result.email;
                document.getElementById('output').innerHTML += "<br>"
                document.getElementById('output').innerHTML += "Profiles: " + result.profile_count
            } catch (error) {
                // Handle errors
                console.error('Error fetching data:', error);
                document.getElementById('output').innerHTML = `Error: ${error.message}`;
            }
        }

        // Query 2
        async function queryTwo() {
            const movie = document.getElementById('movieName').value;
            if (!movie) {
                alert("Please enter the movie name.");
                return;
            }
            try {
                // Make the API request, passing the email as a path parameter
                const response = await fetch(`http://localhost:8001/query_two/${encodeURIComponent(movie)}`);
                // Check if the response is OK
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                // Parse the JSON response
                const result = await response.json();
                document.getElementById('output').innerHTML = "";
                result.forEach((row) => {
                    document.getElementById('output').innerHTML += row;
                    document.getElementById('output').innerHTML += "<br>";
                });
            } catch (error) {
                // Handle errors
                console.error('Error fetching data:', error);
                document.getElementById('output').innerHTML = `Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>
